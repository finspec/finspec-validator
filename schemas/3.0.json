{
    "title": "A JSON Schema for FinSpec v3.0.",
    "id": "https://fixspec.com/finspec/v3.0/schema.json#",
    "$schema": "http://json-schema.org/draft-07/schema#",
    "type": "object",
    "required": [
        "finspec",
        "info",
        "protocol",
		"datatypes",
        "nav",
		"messages"
    ],
    "additionalProperties": false,
    "patternProperties": {
        "^x-": {
            "$ref": "#/definitions/vendorExtension"
        }
    },
    "properties": {
        "finspec": {
            "type": "string",
            "enum": [
                "3.0"
            ],
            "description": "The FinSpec version of this document."
        },
        "info": {
            "$ref": "#/definitions/info"
        },
        "protocol": {
            "$ref": "#/definitions/protocol"
        },
        "changes": {
            "$ref": "#/definitions/changes"
        },
        "datatypes" : {
            "$ref": "#/definitions/datatypes"
        },
        "blocks": {
            "$ref": "#/definitions/blocks"
        },
        "messages": {
            "$ref": "#/definitions/messages"
        },
        "nav": {
            "$ref": "#/definitions/nav"
        },
        "layout": {
            "$ref": "#/definitions/layout"
        },
        "transforms": {
            "$ref": "#/definitions/transformArray"
        },
        "example": {
            "$ref": "#/definitions/examples"
        },        
        "notes": {
            "$ref": "#/definitions/notesArray"
        },
        "workflows": {
            "$ref": "#/definitions/workflows"
        }
    },
    "definitions": {
        "info": {
            "type": "object",
            "description": "General information about the author of the API.",
            "required": [
                "version",
                "issuer",
                "issueDate",
                "title"
            ],
            "additionalProperties": false,
            "patternProperties": {
                "^x-": {
                    "$ref": "#/definitions/vendorExtension"
                }
            },
            "properties": {
                "version": {
                    "type": "string",
                    "description": "A semantic version number of the API."
                },
                "issuer": {
                    "type": "string",
                    "description": "The name of the API issuer."
                },
                "issueDate": {
                    "type": "string",
                    "description": "The issue date of the API description expressed in YYYY-MM-DD format.",
                    "pattern": "^(19|20)\\d{2}-(0\\d|1[012])-([0-2]\\d|3[01])$"
                },
                "liveDate": {
                    "type": "string",
                    "description": "The anticipated production-live date of the API description expressed in YYYY-MM-DD format.",
                    "pattern": "^(19|20)\\d{2}-(0\\d|1[012])-([0-2]\\d|3[01])$"
                },
                "title": {
                    "type": "string",
                    "description": "A unique and precise title of the API service."
                },
                "logo": {
                    "type": "string",
                    "description": "A fully-qualified URL to a suitable logo image for the spec author."
                },
                "contacts": {
                    "$ref": "#/definitions/contacts"
                },
                "status": {
                    "type": "string",
                    "description": "A description of the current state of this specification (eg DRAFT or FINAL)."
                }
            }
        },
        "contacts": {
            "type": "array",
            "minItems": 1,
            "uniqueItems": true,
            "items" : {
                "$ref": "#/definitions/contact"
            },
            "description": "List of contact details for the owners of the API.",
            "additionalProperties": false
        },
        "contact": {
            "type": "object",
            "description": "Contact detail of a person or department within the API owner.",
            "required": [
                "name"
            ],
            "additionalProperties": false,
            "anyOf": [
                {"required": ["phone"]},
                {"required": ["email"]},
                {"required": ["url"]}
            ],
            "properties": {
                "name": {
                    "type": "string",
                    "description": "The identifying name of the contact person/organization."
                },
                "phone": {
                    "type": "string",
                    "description": "The phone number (including international dialing code) for the contact."
                },
                "url": {
                    "type": "string",
                    "description": "The URL pointing to the contact information.",
                    "format": "uri"
                },
                "email": {
                    "type": "string",
                    "description": "The email address of the contact person/organization.",
                    "format": "email"
                }
            },
            "patternProperties": {
                "^x-": {
                    "$ref": "#/definitions/vendorExtension"
                }
            }
        },
        "protocol": {
            "type": "object",
            "description": "Metadata about the protocol used by the API.",
            "required": [
                "name"
            ],
            "additionalProperties": false,
            "anyOf": [
                {"required": ["isFIX"]},
                {"required": ["isOffsetBased"]},
                {"required": ["isTagValue"]},
                {"required": ["isObject"]}
            ],
            "properties": {
                "name": {
                    "type": "string",
                    "description": "The common name for the protocol."
                },
                "description": {
                    "type": "string",
                    "description": "An optional description of the protocol."
                },
                "isFIX": {
                    "type": "boolean",
                    "description": "Is this the FIX protocol? (Useful short-cut for one of the most popular protocols)."
                },
                "isOffsetBased": {
                    "type": "boolean",
                    "description": "Is this a offset-based message such as ITCH?"
                },
                "isTagValue": {
                    "type": "boolean",
                    "description": "Is the protocol tag-value based, such as FIX or SWIFT?"
                },
                "isObject": {
                    "type": "boolean",
                    "description": "Does the specification describe the set of object attributes returned from an SDK?"
                },
                "isBinary": {
                    "type": "boolean",
                    "description": "Indicates whether protocol is text or binary."
                },
                "endianness" : {
                    "type": "string",
                    "enum": [
                        "little",
                        "big"
                    ],
                    "description": "Default endianness of numerical types for binary/native APIs."
                },
                "charset" : {
                    "type": "string",
                    "description": "Legal character set used for string values e.g. 'UTF8', 'ISO 8859-1', etc."
                },
                "hasHeader": {
                    "type": "boolean",
                    "description": "Do messages in this protocol always have a defined header block?"
                },
                "hasTrailer": {
                    "type": "boolean",
                    "description": "Do messages in this protocol always have a defined trailer (footer) block?"
                }
            },
            "patternProperties": {
                "^x-": {
                    "$ref": "#/definitions/vendorExtension"
                }
            }
        },
        "changes": {
            "type": "object",
            "description": "An optional block providing a description of changes in this, and prior, spec versions.",
            "required": [
                "summary"
            ],
            "additionalProperties": false,
            "anyOf": [
                {"required": ["lastVersion"]},
                {"required": ["lastVersionDate"]}
            ],
            "properties": {
                "summary": {
                    "type": "string",
                    "description": "A HTML or text description of the latest changes made."
                },
                "lastVersion": {
                    "type": "string",
                    "description": "The version number of the immediately prior spec version (i.e. the starting spec to which changes have been applied)."
                },
                "lastVersionDate": {
                    "type": "string",
                    "description": "The date of the immediately prior spec version (i.e. the starting spec to which changes have been applied) in YYYY-MM-DD format.",
                    "pattern": "^(19|20)\\d{2}-(0\\d|1[012])-([0-2]\\d|3[01])$"
                },
                "history": {
                    "$ref": "#/definitions/history"
                }
            },
            "patternProperties": {
                "^x-": {
                    "$ref": "#/definitions/vendorExtension"
                }
            }
        },
        "history": {
            "type": "array",
            "minItems": 1,
            "uniqueItems": true,
            "items" : {
                "$ref": "#/definitions/historyRecord"
            },
            "description": "An optional block providing a description of changes in prior, spec versions.",
            "additionalProperties": false
        },
        "historyRecord": {
            "type": "object",
            "description": "An individual history record entry.",
            "required": [
                "version",
                "issueDate",
                "summary"
            ],
            "additionalProperties": false,
            "properties": {
                "version": {
                    "type": "string",
                    "description": "The spec version number to which this history record relates."
                },
                "issueDate": {
                    "type": "string",
                    "description": "The issue date of the spec to which this history record relates, in YYYY-MM-DD format.",
                    "pattern": "^(19|20)\\d{2}-(0\\d|1[012])-([0-2]\\d|3[01])$"
                },
                "liveDate": {
                    "type": "string",
                    "description": "The live date of the spec version to which this history record relates, in YYYY-MM-DD format.",
                    "pattern": "^(19|20)\\d{2}-(0\\d|1[012])-([0-2]\\d|3[01])$"
                },
                "summary": {
                    "type": "string",
                    "description": "A HTML or text description of the changes applied in the indicated spec version."
                }
            },
            "patternProperties": {
                "^x-": {
                    "$ref": "#/definitions/vendorExtension"
                }
            }
        },
        "datatypes": {
            "type": "array",
            "minItems": 1,
            "uniqueItems": true,
            "items" : {
                "$ref": "#/definitions/datatype"
            },
            "description": "List of datatypes used by the API.",
            "additionalProperties": false
        },
        "datatype": {
            "type": "object",
            "description": "Description of a specific datatype used by the API.",
            "required": [
                "name",
                "baseType",
                "description"
            ],
            "additionalProperties": false,
            "properties": {
                "name": {
                    "type": "string",
                    "description": "Name of the type. e.g. int, uint8e, Price, Boolean, etc."
                },
                "baseType": {
                    "type": "string",
                    "description": "Specifies the base/raw data type of the value.",
                    "enum" : [
                        "char",
                        "integer",
                        "number",
                        "string",
                        "pattern",
                        "int8",
                        "uint8",
                        "int16",
                        "uint16",
                        "int32",
                        "uint32",
                        "int64",
                        "uint64",
                        "float",
                        "double",
                        "ascii",
                        "utf8",
                        "aqxtime",
                        "aqxproto",
                        "aqxprice",
                        "lsetime64",
                        "lsetime32",
                        "bytehex",
                        "lsetime6",
                        "lsedate",
                        "lsetime8",
                        "saildate1",
                        "saildate2",
                        "saildate3",
                        "sailprice",
                        "sailsign",
                        "sailtime1",
                        "sailtime2",
                        "boolean",
                        "byte",
                        "enum",
                        "short",
                        "ushort",
                        "int",
                        "uint",
                        "long",
                        "ulong",
                        "ldate",
                        "ltime",
                        "mtime",
                        "utime",
                        "String",
                        "xs:string",
                        "xs:integer",
                        "xs:decimal",
                        "xs:dateTime",
                        "xs:time",
                        "xs:date"
                    ]
                },
                "length": {
                    "type": "integer",
                    "description": "Length of value for this type in number of bytes."
                },
                "precision": {
                    "type": "integer",
                    "description": "Precision for floating point type value."
                },
                "isUnsigned": {
                    "type": "boolean",
                    "description": "Whether numerical value is unsigned or not. Default: false"
                },
                "isBitField": {
                    "type": "boolean",
                    "description": "Whether type represents a bit field. Default: false"
                },
                "pattern": {
                    "type": "string",
                    "description": "Regular expression to describe the pattern of the value for this datatype."
                },
                "padChar": {
                    "type": "string",
                    "description": "Character used for padding."
                },
                "padSide": {
                    "type": "string",
                    "description": "Whether field value should be padded to left or right.",
                    "enum" : [
                        "left",
                        "right"
                    ]
                },
                "description": {
                    "type": "string",
                    "description": "Description/remark for this type."
                },
                "examples": {
                    "type": "array",
                    "description": "Array of simple, text examples.",
                    "minItems": 1,
                    "items": {
                        "type": "string"
                    }
                }
            },
            "patternProperties": {
                "^x-": {
                    "$ref": "#/definitions/vendorExtension"
                }
            }
        },
        "blocks": {
            "description": "A re-usable field block (such as common header of trailer).",
            "type": "object",
            "additionalProperties": {
                "$ref": "#/definitions/fieldSet"
            }
        },
        "messages": {
            "type": "object",
            "description": "List of messages supported by this API spec.",
            "anyOf": [
                {"required": ["info"]},
                {"required": ["technical"]}
            ],
            "properties" : {
                "info": {
                    "description": "Informational messages which do not contain fields.",
                    "type": "object",
                    "properties": {
                        "/": {}
                    },
                    "patternProperties": {
                        "^.+$": {
                            "$ref": "#/definitions/infoSection"
                        }
                    },
                    "additionalProperties": false
                },
                "technical": {
                    "description": "Messages used for establishing, maintaining and closing API sessions.",
                    "type": "object",
                    "properties": {
                        "/": {}
                    },
                    "patternProperties": {
                        "^.+$": {
                            "$ref": "#/definitions/fieldSet"
                        }
                    },
                    "additionalProperties": false
                },
                "functional": {
                    "description": "Functional (context-specific) message descriptions.",
                    "type": "object",
                    "properties": {
                        "/": {}
                    },
                    "patternProperties": {
                        "^.+$": {
                            "$ref": "#/definitions/fieldSetWithContext"
                        }
                    },
                    "additionalProperties": false
                }
            }
        },
        "infoSection": {
            "type": "object",
            "description": "Informational section",
            "required": [
                "name",
                "description"
            ],
            "additionalProperties": false,
            "properties": {
                "name": {
                    "type": "string",
                    "description": "Name of the section."
                },
                "description": {
                    "type": "string",
                    "description": "HTML or plain text content."
                },
                "key": {
                    "type": "string",
                    "description": "Unique identifier (key) for the information section, as indicated in the nav block."
                },
                "historyKey": {
                    "type": "string",
                    "description": "Linking identifier that is persisted across spec versions for this object, facilitating cross-version comparison."
                },
                "notes": {
                    "$ref": "#/definitions/notesArray"
                }
            },
            "patternProperties": {
                "^x-": {
                    "$ref": "#/definitions/vendorExtension"
                }
            }
        },
        "fieldSet": {
            "type": "object",
            "description": "Description of a set of fields (message or block) within the API.",
            "required": [
                "name",
                "description",
                "fields"
            ],
            "additionalProperties": false,
            "properties": {
                "name": {
                    "type": "string",
                    "description": "Name of the message."
                },
                "wireId": {
                    "type": "string",
                    "description": "Unique, wire identifier for the message (eg tag 35 in FIX)."
                },
                "description": {
                    "type": "string",
                    "description": "Description of the purpose and use of the message."
                },
                "key": {
                    "type": "string",
                    "description": "Unique identifier (key) for the message, as indicated in the corresponding block."
                },
                "historyKey": {
                    "type": "string",
                    "description": "Linking identifier that is persisted across spec versions for this object, facilitating cross-version comparison."
                },
                "isSession": {
                    "type": "boolean",
                    "description": "Whether this fieldset relates to establishing, maintaining or terminating an API session."
                },
                "isHeader": {
                    "type": "boolean",
                    "description": "Whether this fieldset describes a re-usable header block."
                },
                "isTrailer": {
                    "type": "boolean",
                    "description": "Whether this fieldset describes a re-usable trailer (footer) block."
                },
                "fields": {
                    "$ref": "#/definitions/fieldArray"
                },
                "direction": {
                    "type": "string",
                    "description": "Indication of message flow. Default is both.",
                    "enum" : [
                        "in",
                        "out",
                        "both"
                    ]
                },
                "examples": {
                    "type": "array",
                    "description": "Array of keys referring to entries in the global examplesObject.",
                    "minItems": 1,
                    "items": {
                        "type": "string"
                    }
                },
                "notes": {
                    "$ref": "#/definitions/notesArray"
                }
            },
            "patternProperties": {
                "^x-": {
                    "$ref": "#/definitions/vendorExtension"
                }
            }
        },
        "fieldSetWithContext": {
            "type": "object",
            "description": "Description of a functional (context-specific) application-level message within the API.",
            "required": [
                "name",
                "wireId",
                "description",
                "fields",
                "context"
            ],
            "additionalProperties": false,
            "properties": {
                "name": {
                    "type": "string",
                    "description": "Name of the message."
                },
                "wireId": {
                    "type": "string",
                    "description": "Wire identifier for the message (eg tag 35 in FIX)."
                },
                "description": {
                    "type": "string",
                    "description": "Description of the purpose and use of the message."
                },
                "isSession": {
                    "type": "boolean",
                    "description": "Whether this fieldset relates to establishing, maintaining or terminating an API session."
                },
                "context" : {
                    "$ref": "#/definitions/context"
                },
                "fields": {
                    "$ref": "#/definitions/fieldArray"
                },
                "key": {
                    "type": "string",
                    "description": "Unique identifier (key) for the message, as indicated in the corresponding block."
                },
                "baseKey": {
                    "type": "string",
                    "description": "Unique identifier (key) for the technical message upon which this functional view is based."
                },
                "historyKey": {
                    "type": "string",
                    "description": "Linking identifier that is persisted across spec versions for this object, facilitating cross-version comparison."
                },
                "direction": {
                    "type": "string",
                    "description": "Indication of message flow. Default is both.",
                    "enum" : [
                        "in",
                        "out",
                        "both"
                    ]
                },
                "examples": {
                    "type": "array",
                    "description": "Array of keys referring to entries in the global examplesObject.",
                    "minItems": 1,
                    "items": {
                        "type": "string"
                    }
                },
                "notes": {
                    "$ref": "#/definitions/notesArray"
                }
            },
            "patternProperties": {
                "^x-": {
                    "$ref": "#/definitions/vendorExtension"
                }
            }
        },
        "fieldArray": {
            "type": "array",
            "minItems": 1,
            "items" : {
                "$ref": "#/definitions/field"
            },
            "description": "List of fields available within a fieldset (message or block).",
            "additionalProperties": false,
            "patternProperties": {
                "^x-": {
                    "$ref": "#/definitions/vendorExtension"
                }
            }
        },
        "field": {
            "type": "object",
            "description": "Description of a specific field within a fieldSet (message or block).",
            "required": [
                "name"
            ],
            "anyOf": [
                {"required": ["blockKey"]},
                {"required": ["datatype"]}
            ],
            "additionalProperties": false,
            "properties": {
                "offset": {
                    "type": "integer",
                    "description": "Zero-based offset of the field within the message for binary APIs."
                },
                "position": {
                    "type": "integer",
                    "description": "Zero-based position of the field within the message for text/tag-value APIs. Where absent, ordering should be assumed from positioning within the JSON."
                },
                "wireId": {
                    "type": "string",
                    "description": "Wire identifier for the field (eg tag 35 in FIX)."
                },
                "key": {
                    "type": "string",
                    "description": "The unique reference for the field."
                },
                "blockKey": {
                    "type": "string",
                    "description": "The unique reference for the block from the `blocks` section."
                },
                "description": {
                    "type": "string",
                    "description": "Description of the purpose and use of the field."
                },
                "name": {
                    "type": "string",
                    "description": "Name of the field."
                },
                "datatype": {
                    "type" : "string",
                    "description" : "Field datatype from the list of API datatypes."
                },
                "minValue": {
                    "type": "number",
                    "description" : "Minimum permitted field value for numeric types."
                },
                "maxValue": {
                    "type": "number",
                    "description" : "Maximum permitted field value for numeric types."
                },
                "defaultValue": {
                    "type": "string",
                    "description" : "default value in field."
                },
                "exclusiveMinValue": {
                    "type": "boolean",
                    "description" : "Whether 'minValue' value is exclusive or not."
                },
                "exclusiveMaxValue": {
                    "type": "boolean",
                    "description" : "Whether 'maxValue' value is exclusive or not."
                },
                "minLength": {
                    "type": "integer",
                    "description" : "Minimum permitted length of value for string types."
                },
                "maxLength": {
                    "type": "integer",
                    "description" : "Maximum permitted length of value for string types."
                },
                "length": {
                    "type": "integer",
                    "description" : "Field value length in number of bytes (binary) or characters (text)."
                },
                "values": {
                    "$ref": "#/definitions/enumArray",
                     "description": "List of possible values for this field."
                },
                "pattern": {
                    "type": "string",
                    "description": "Regular expression to describe the pattern of the value for this field."
                },
                "alwaysRequired": {
                    "type": "boolean",
                    "description": "Boolean flag to indicate that this field is present in 100% of cases. Default: false"
                },
                "conditions": {
                    "$ref": "#/definitions/conditions",
                    "description": "Section defining field conditional requirements"
                },
                "fields": {
                    "$ref": "#/definitions/fieldArray",
                    "description": "List of nested fields, indicating a repeating group under the current field."
                },
                "bits": {
                    "description": "Details about how bits are organized in current bit field.",
                    "type": "array",
                    "minItems": 1,
                    "items" : {
                        "$ref": "#/definitions/bit"
                    },
                    "additionalProperties": false
                },
                "notes": {
                    "$ref": "#/definitions/notesArray"
                }
            },
            "dependencies": {
                "exclusiveMinValue": [ "minValue" ],
                "exclusiveMaxValue": [ "maxValue" ]
            },
            "patternProperties": {
                "^x-": {
                    "$ref": "#/definitions/vendorExtension"
                }
            }
        },
        "context": {
            "type": "object",
            "required": [
                "expressionType",
                "expression",
                "description"
            ],
            "properties" : {
                "lang": {
                    "type": "string",
                    "description": "Type of grammar used in expression field. Default: groovy.",
                    "enum": ["javascript", "groovy"]
                },
                "expression": {
                    "type": "string",
                    "description": "Expression. The message context is considered to be in effect if this expression evaluates to true."
                },
                "description": {
                    "type": "string",
                    "description": "Human-readable descirption of the context."
                }
            },
            "description": "Description of the message context.",
            "additionalProperties": false,
            "patternProperties": {
                "^x-": {
                    "$ref": "#/definitions/vendorExtension"
                }
            }
        },
        "bit": {
            "type": "object",
            "description": "Description of a specific bit within a group of bits.",
            "required": [
                "name",
                "offset",
                "width"
            ],
            "additionalProperties": false,
            "properties": {
                "name": {
                    "type": "string",
                    "description": "Name of the bit field."
                },
                "description": {
                    "type": "string",
                    "description": "Description of this bit field."
                },
                "offset": {
                    "type": "integer",
                    "description": "Bit offset within this bit group."
                },
                "width": {
                    "type": "integer",
                    "description": "Width of bit."
                },
                "values": {
                    "$ref": "#/definitions/enumArray",
                     "description": "List of possible values for this bit."
                }
            },
            "patternProperties": {
                "^x-": {
                    "$ref": "#/definitions/vendorExtension"
                }
            }
        },
        "enumArray": {
            "type": "array",
            "minItems": 1,
            "uniqueItems": true,
            "items" : {
                "$ref": "#/definitions/enum"
            },
            "description": "List of possible values for a field.",
            "additionalProperties": false
        },
        "enum": {
            "type": "object",
            "description": "Description of an enumerated, valid value.",
            "required": [
                "wireValue"
            ],
            "anyOf": [
                {"required": ["name"]},
                {"required": ["description"]}
            ],
            "additionalProperties": false,
            "properties": {
                "wireValue": {
                    "oneOf": [
                        { "type": "string" },
                        { "type": "number" }
                    ],
                    "description": "Enumeration as it appears on the wire."
                },
                "name" : {
                    "type": "string",
                    "description": "Short, common name for this enumeration."
                },
                "description": {
                    "type": "string",
                    "description": "Longer description of enumerated value."
                }
            },
            "patternProperties": {
                "^x-": {
                    "$ref": "#/definitions/vendorExtension"
                }
            }
        },
        "conditions": {
            "type": "array",
            "description": "Field conditional requirements",
            "required": [
                "conditions"
            ],
            "additionalProperties": false,
            "properties": {
                "label": {
                    "type": "string",
                    "description": "Decription of the condition rule."
                },
                "lang": {
                    "type": "string",
                    "description": "Type of grammar used in expression field.",
                    "enum": ["javascript", "groovy"]
                },
                "expression": {
                    "type": "string",
                    "description": "Condition expression. Below block matters if this expression evaluates to true."
                },
                "isReqd": {
                    "type": "boolean",
                    "description": "Field is mandatory in such conditions"
                },
                "isAbsent": {
                    "type": "boolean",
                    "description": "Field should not be present in such conditions"
                },
                "values": {
                    "$ref": "#/definitions/enumArray",
                    "description": "Restricted set of permitted enumerations when the conditions described above are true"
                }
            },
            "patternProperties": {
                "^x-": {
                    "$ref": "#/definitions/vendorExtension"
                }
            }
        },
        "nav": {
            "type": "object",
            "anyOf": [
                {"required": ["technical"]},
                {"required": ["functional"]},
                {"required": ["info"]},
                {"required": ["block"]}
            ],
            "description": "Specification navigation",
            "properties": {
                "technical": {
                    "type": "object",
                    "description": "Navigation for all technical messages.",
                    "$ref": "#/definitions/navSection"
                },
                "functional": {
                    "type": "object",
                    "description": "Navigation for all functional views (context-specific fieldsets).",
                    "$ref": "#/definitions/navSection"
                },
                "info": {
                    "type": "object",
                    "description": "Navigation for all information sections.",
                    "$ref": "#/definitions/navSection"
                },
                "block": {
                    "type": "object",
                    "description": "Navigation for all re-usable fieldsets.",
                    "$ref": "#/definitions/navSection"
                }
            },
            "additionalProperties": false,
            "patternProperties": {
                "^x-": {
                    "$ref": "#/definitions/vendorExtension"
                }
            }
        },
        "navSection": {
            "type": "object",
            "description": "Navigation section containing further menu items.",
            "additionalProperties": {
                "$ref": "#/definitions/navSubSection"
            }
        },
        "navSubSection": {
            "type": "object",
            "description": "Navigation sub-section containing further menu items.",
            "anyOf": [
                {"required": ["items"]},
                {"required": ["menu"]}
            ],
            "additionalProperties": false,
            "properties": {
                "items": {
                    "$ref": "#/definitions/navItemArray"
                },
                "menu": {
                    "$ref": "#/definitions/navSection"
                }
            }
        },
        "navItemArray": {
            "type": "array",
            "minItems": 0,
            "uniqueItems": true,
            "items" : {
                "$ref": "#/definitions/navItem"
            },
            "description": "Container for navigation items",
            "additionalProperties": false
        },
        "navItem": {
            "type": "object",
            "description": "Individual navigation item",
            "additionalProperties": false,
            "required": [
                "key",
                "name"
            ],
            "properties": {
                "key": {
                    "type": "string",
                    "description": "Unique key linking for the information section or fieldset. Links to the key found in the relevant blocks or messages object"
                },
                "name": {
                    "type": "string",
                    "description": "Name of the section or fieldset."
                }
            },
            "patternProperties": {
                "^x-": {
                    "$ref": "#/definitions/vendorExtension"
                }
            }
        },
        "layout": {
            "type": "array",
            "minItems": 1,
            "description": "A logical section within the document (equivalent to a section within a word processing document",
            "properties": {
                "prepend": {
                    "type": "string",
                    "description": "HTML content to be output before any pages in this section."
                },
                "append": {
                    "type": "string",
                    "description": "HTML content to be output after all pages in this section."
                },
                "orientation": {
                    "type": "string",
                    "description": "The page orientation used for Word/PDF. Default is portrait.",
                    "enum": [
                        "portrait",
                        "landscape" 
                    ]
                },
                "pages": {
                    "type": "array",
                    "minItems": 1,                    
                    "description": "An array of pages contained in this section. Each page ends with an implicit page break.",
                    "$ref": "#/definitions/layoutPage"
                }
            },
            "additionalProperties": false,
            "patternProperties": {
                "^x-": {
                    "$ref": "#/definitions/vendorExtension"
                }
            }
        }, 
        "layoutPage": {
            "type": "object",
            "description": "A sub-section within a document which ends with an explicit page break. This may extend over multiple printed pages.",
            "properties": {
                "prepend": {
                    "type": "string",
                    "description": "HTML content to be output before any messages on this page."
                },
                "append": {
                    "type": "string",
                    "description": "HTML content to be output after all messages on this page."
                },
                "messages": {
                    "type": "array",
                    "description": "An ordered array of message references which should be displayed on this page.",
                    "$ref": "#/definitions/layoutPageMessage"
                }
            },
            "additionalProperties": false,
            "patternProperties": {
                "^x-": {
                    "$ref": "#/definitions/vendorExtension"
                }
            }
        },
        "layoutPageMessage": {
            "type": "object",
            "description": "A reference object to a message described within this FinSpec.",
            "required": [
                "type",
                "key"
            ],
            "properties": {
                "type": {
                    "type": "string",
                    "description": "The type of message to be output.",
                    "enum": [
                        "info",
                        "block",
                        "technical",
                        "functional"
                    ]
                },
                "key": {
                    "type": "string",
                    "description": "The unique reference for this message."
                }
            },
            "additionalProperties": false,
            "patternProperties": {
                "^x-": {
                    "$ref": "#/definitions/vendorExtension"
                }
            }
        },
        "examples": {
            "type": "object",
            "description": "A keyed array of examples (of various types) that can be referenced elsewhere in the FinSpec.",
            "required": [
                "description"
            ],
            "properties": {
                "name": {
                    "type": "string",
                    "description": "Example name or title. Plain text only."
                },
                "raw": {
                    "type": "string",
                    "description": "Actual example of a complete message (not just a fragement of it). Plain text only."
                },
                "example": {
                    "type": "string",
                    "description": "User-friendly HTML intended to let users understand the example more clearly, for example by only listing certain fields/values of interest."
                },
                "description": {
                    "type": "string",
                    "description": "Description (or purpose) of the example. May contain HTML."
                }               
            },
            "additionalProperties": false,
            "patternProperties": {
                "^x-": {
                    "$ref": "#/definitions/vendorExtension"
                }
            }
        }, 
        "workflows": {
            "type": "object",
            "description": "Description of the specific business case modelled in the workflow.",
            "required": [
                "nav",
                "states",
                "transitions"
            ],
            "additionalProperties": false,
            "properties": {
			   "nav": {
                    "type": "array",
                    "minItems": 1,
                    "uniqueItems": true,
                    "items" : {
                        "$ref": "#/definitions/workflowNav"
                    },
                    "description": "List of messages included in the workflow",
                    "additionalProperties": false
			   },
                "states": {
                    "type": "array",
                    "minItems": 1,
                    "uniqueItems": true,
                    "items" : {
                        "$ref": "#/definitions/state"
                    },
                    "description": "Set of states available in this workflow",
                    "additionalProperties": false
                },
                "events": {
                    "type": "array",
                    "minItems": 1,
                    "uniqueItems": true,
                    "items" : {
                        "$ref": "#/definitions/event"
                    },
                    "description": "Set of events available in this workflow",
                    "additionalProperties": false
                },
                "transitions": {
                    "type": "array",
                    "minItems": 1,
                    "uniqueItems": true,
                    "items" : {
                        "$ref": "#/definitions/transition"
                    },
                    "description": "List of events that causes the workflow to transition to another state",
                    "additionalProperties": false
                }
            }
        },
        "workflowNav": {
            "type": "object",
            "description": "Organised list of workflow ",
            "required": [
                "messageType"
            ],
            "additionalProperties": false,
            "properties": {
               "name": {
                  "type": "string",
                  "description": "Name of the workflow."
                },
               "description": {
                  "type": "string",
                  "description": "Description of the workflow described"
                }
            }
        },
        "state": {
            "type": "object",
            "description": "Individual state composing of the workflow",
            "required": [
                "nav"
            ],
            "additionalProperties": false,
            "properties": {
                "nav": {
                   "type": "string",
                   "description": "Unique reference of the related workflow"
                },
                "name": {
                    "type": "string",
                    "description": "Short description of the state"
                },
                "description": {
                    "type": "string",
                    "description": "Human-readable description of the state."
                },
                "isInitial": {
                    "type": "boolean",
                    "description": "This is the initial state of the workflow."
                },
                "isFinal": {
                    "type": "boolean",
                    "description": "This is the final state of the workflow."
                },
                "isDefaultError": {
                    "type": "boolean",
                    "description": "Is this the default rejection state-message?"
                }
            }
        },
        "event": {
            "type": "object",
            "description": "Individual event available in the workflow",
            "additionalProperties": false,
            "properties": {
                "description": {
                    "type": "string",
                    "description": "Human-readable description of the event."
                },
                "time": {
                    "type": "string",
                    "description": "Time in UTC when event is triggered HH:MM:SS"
                }
            }
        },
        "transition": {
            "type": "object",
            "description": "details of the transition phase with triggering action and end state",
            "required": [
                "start",
                "responses"
              ],
            "additionalProperties": false,
            "properties": {
                "nav": {
                   "type": "string",
                   "description": "Unique reference of related workflow"
                },
                "description": {
                    "type": "string",
                    "description": "Human-readable description of the state."
                },
                "start": {
                    "type": "array",
                    "minItems": 1,
                    "uniqueItems": true,
                    "description": "List of possible start states",
					"items" : {
                        "type": "string"
                    }
                },
                "trigger": {
                    "$ref": "#/definitions/trigger",
                    "description": "Event that triggers the transition"
                },
                "responses": {
                    "type": "array",
                    "minItems": 1,
                    "uniqueItems": true,
                    "items" : {
                        "$ref": "#/definitions/response"
                    }
                }
            }
        },
        "trigger": {
            "type": "object",
            "description": "Event that triggers the transition",
            "required": [
                "type",
                "key"
            ],
            "additionalProperties": false,
            "properties": {
               "type": {
                    "type": "string",
                    "description": "type of the key element",
	                "enum" : [
                        "technical",
                        "event",
                        "functional"
                    ]
                },
                "key": {
                    "type": "string",
                    "description": "key of the message or event"
                },
                "direction": {
                    "type": "string",
                    "description": "Indication of message flow.",
                    "enum" : [
                        "in",
                        "out"
                    ]
                },
                "where": {
                    "type": "string",
                    "description": "Condition expression field (type groovy)."
                }
            }
        },
        "response": {
            "type": "object",
            "description": "Possible message response",
            "required": [
                "type",
                "messageKey"
            ],
            "additionalProperties": false,
            "properties": {
               "type": {
                    "type": "string",
                    "description": "type of the key element",
	                "enum" : [
                        "technical",
                        "functional"
                    ]
                },
                "messageKey": {
                    "type": "string",
                    "description": "key of the message or event"
                },
                "description": {
                    "type": "string",
                    "description": "Human-readable description of the response."
                },
                "with": {
                    "type": "array",
                    "minItems": 1,
                    "uniqueItems": true,
                    "items" : {
                        "$ref": "#/definitions/with"
                    }
                },
                "end": {
                    "type": "string",
                    "description": "resulting state"
                },
                "isSuccess": {
                    "type": "boolean",
                    "description": "Is this a successful response to the action"
                }
           }
        },

        "with": {
            "type": "object",
            "description": "Conditions to determine the value of the field",
            "additionalProperties": false,
            "oneOf" : [
                { "$ref": "#/definitions/withSimpleValue" },
                { "$ref": "#/definitions/withReferencedValue" },
                { "$ref": "#/definitions/withRange" },
                { "$ref": "#/definitions/withMath" },
                { "$ref": "#/definitions/withIf" }
            ]
        },

        "withSimpleValue": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "fixed": {
                    "type": "string",
                    "description": "Fixed value input in field"
                },
                "date": {
                    "type": "string",
                    "description": "date to be computed in the following format YYYYMMDD. Can also be a compute instruction like TODAY, YESTERDAY"
                },
                "time": {
                    "type": "string",
                    "description": "Time in timestampUTC. Can also be a compute instruction like NOW"
                }
            },
            "oneOf":[
                { "required": [ "fixed" ] },
                { "required": [ "date" ] },
                { "required": [ "time" ] }
            ]
        },

        "withReferencedValue": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "this": {
                    "type": "integer",
                    "description": "tag of the field from which the value is copied - in this message"
                },
                "last": {
                    "type": "integer",
                    "description": "tag of the field from which the value is copied - in previous linked message"
                },
                "default": {
                    "type": "string",
                    "description": "Default value if not compute from another field"
                }
            },
            "oneOf":[
                { "required": [ "this" ] },
                { "required": [ "last", "default" ] }
            ]
        },

        "withRange" : {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "min": {
                    "type": "object",
                    "description": "Min value of this field - used for integer fields",
					"$ref": "#/definitions/with"
                },
                "max": {
                    "type": "object",
                    "description": "Max value of this field - used for integer fields",
					"$ref": "#/definitions/with"
                }
            }
        },

        "withMath" : {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "sum": {
                    "type": "array",
                    "description": "sum operator",
                    "items" : {
                        "$ref": "#/definitions/with"
                    }
                },
                "substract": {
                    "type": "array",
                    "description": "substraction operator",
                    "items" : {
                        "$ref": "#/definitions/with"
                    }
                },
                "multiply": {
                    "type": "array",
                    "description": "divide operator",
                    "items" : {
                        "$ref": "#/definitions/with"
                    }
                },
                "divide": {
                    "type": "array",
                    "description": "divide operator",
                    "properties" : {
                        "numerator" : {
                            "$ref": "#/definitions/with"
                        },
                        "denominator" : {
                            "$ref": "#/definitions/with"
                        }
                    }
                }
            }
        },
        "withIf": {
            "type": "object",
            "description": "Signifying the block with different set of conditions",
            "additionalProperties": false,
            "properties": {
                "if": {
                    "type": "array",
                    "description": "Contains blocks with different conditions",
                    "items" : [
                        { "$ref": "#/definitions/withCondition" }
                    ]
                }
            }
        },
        "withCondition": {
            "type": "object",
            "description": "Conditional with block for specify the conditional values",
            "additionalProperties": false,
            "allOf": [
                {
                    "properties": {
                        "condition": {
                            "type": "string",
                            "description": "tag condition expressed in groovy expression"
                        }
                    }
                },
                {
                    "$ref": "#/definitions/with"
                }
            ]
        },
        "vendorExtension": {
            "description": "Any property starting with x- is valid.",
            "additionalProperties": true,
            "additionalItems": true
        },
        "notesArray": {
            "description": "Public notes at different levels: Spec, Message, Block or Field",
            "additionalProperties": false,
            "type": "array",
            "items": [
                {
                    "type" : "object",
                    "required": [ "note", "createdByText", "updatedAt"],
                    "properties": {
                        "note" : {
                            "type" : "string",
                            "description": "A HTML or text note content."
                        },
                        "createdByText" : {
                            "type" : "string",
                            "description": "User who created the note"
                        },
                        "updatedAt" : {
                            "type" : "string",
                            "description": "Time the note was last updated in YYYY-MM-DD HH:mm:SS format"
                        }
                    },
                    "additionalProperties": true
                }
            ]
        },
        "transformsArray": {
            "description": "An array of transformations to be performed by the receiving application",
            "additionalProperties": false,
            "type": "array",
            "items": [
                {
                    "type": "object",
                    "required": [
                        "actions"
                    ],
                    "properties": {
                        "scope": {
                            "$ref": "#/definitions/transformScope"
                        },
                        "actions": {
                            "$ref": "#/definitions/transformActionArray"
                        }
                    },
                    "additionalProperties": true
                }
            ]
        },
        "transformScope": {
            "description": "Used to filter the scope of the transform to messages which match the scope.",
            "additionalProperties": true,
            "type": "object",
            "properties": {
                "type": {
                    "description": "Used to identify the type of messages on which to perform the action.",
                    "type": "string",
                    "enum": [
                        "block",
                        "technical",
                        "functional"
                    ]
                },
                "key": {
                    "description": "The relevant unique key for the block / message targetted by this transformation.",
                    "type": "string"
                }, 
                "direction": {
                    "description": "The direction of the message.",
                    "type": "string",
                    "enum": [
                        "in",
                        "out",
                        "both"
                    ]                    
                },
                "lang": {
                    "description": "Language used for the `condition` field. Default of `groovy`",
                    "type": "string",
                    "enum": [
                        "groovy",
                        "javascript"
                    ]
                },   
                "condition": {
                    "description": "An expression evaluating to a boolean, where tag numbers are prefixed with the '$' sign.",
                    "type": "string"
                } 
            }
        },
        "transformActionArray": {
            "description": "An array of transformation actions that should be performed (in the order of intended application) on scoped messages.",
            "additionalProperties": false,
            "type": "array",
            "items": [
                {
                    "type": "object",
                    "required": [
                        "type"
                    ],
                    "properties": {
                        "type": {
                            "description": "Identifies the type of action to be performed.",
                            "type": "string",
                            "enum": [
                                "drop",
                                "store",
                                "expression",
                                "plugin"
                            ]
                        },
                        "tag": {
                            "description": "The tag to be dropped for `drop` types. Ignored for any other `type`.",
                            "type": "string"
                        },
                        "uid": {
                            "description": "An expression to generate a unique index for the sotrage of The tag to be dropped for `drop` types. Ignored for any other type.",
                            "type": "string"
                        },
                        "lang": {
                            "description": "Language used for the `expression` field. Default of `groovy`",
                            "type": "string",
                            "enum": [
                                "groovy",
                                "javascript"
                            ]
                        },
                        "expression": {
                            "description": "An expression to manipulate a field in a message, set or retrieve a $UID from storage, or to a call to an external plugin.",
                            "type": "string"
                        },
                        "additionalProperties": true
                    }
                }
            ]
        }
    }
}
